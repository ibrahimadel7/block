<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tests | AcademyBlock</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f7f9fc; }
    .card { border-radius: 16px; }
    .test-header { font-size: 2rem; font-weight: 600; margin-bottom: 24px; }
    .search-bar { max-width: 320px; }
    .filter-bar { max-width: 180px; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light" style="background:#4a90e2;">
    <div class="container-fluid">
      <a class="navbar-brand text-white" href="index.html">AcademyBlock</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link text-white" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link text-white active" href="tests.html">Tests</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="dashboard.html">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="#">Profile</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <div class="test-header">Tests</div>
    <div class="d-flex gap-3 mb-4">
      <input type="text" class="form-control search-bar" placeholder="Search tests..." id="searchInput">
      <select class="form-select filter-bar" id="filterSelect">
        <option value="">All Levels</option>
        <option value="Beginner">Beginner</option>
        <option value="Intermediate">Intermediate</option>
        <option value="Advanced">Advanced</option>
      </select>
    </div>
    <div id="examsList" class="row g-4"></div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module">
    import { HttpAgent, Actor } from "@dfinity/agent";
    import { idlFactory } from "../src/declarations/backend/backend.did.js";
    const canisterId = "uxrrr-q7777-77774-qaaaq-cai";
    const agent = new HttpAgent({ host: "http://127.0.0.1:4943" });
    const backend = Actor.createActor(idlFactory, { agent, canisterId });
    let exams = [];
    async function loadExams() {
      try {
        exams = await backend.list_exams();
        renderExams();
      } catch (err) {
        alert("Error loading exams: " + err);
      }
    }
    function renderExams() {
      const search = document.getElementById("searchInput").value.toLowerCase();
      const filter = document.getElementById("filterSelect").value;
      const filtered = exams.filter(exam =>
        (!search || exam.title.toLowerCase().includes(search)) &&
        (!filter || exam.level === filter)
      );
      document.getElementById("examsList").innerHTML = filtered.map(exam => `
        <div class='col-md-4'>
          <div class='card p-3'>
            <div class='card-body'>
              <h5 class='card-title'>${exam.title}</h5>
              <p class='card-text'>Level: ${exam.level || "N/A"}</p>
              <button class='btn btn-primary' onclick='startTest(${exam.id})'>Start Test</button>
            </div>
          </div>
        </div>
      `).join("");
    }
    window.startTest = function(examId) {
      localStorage.setItem("currentExamId", examId);
      window.location.href = "test.html";
    };
    document.getElementById("searchInput").oninput = renderExams;
    document.getElementById("filterSelect").onchange = renderExams;
    loadExams();
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tests | AcademyBlock</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f7f9fc; }
    .card { border-radius: 16px; }
    .test-header { font-size: 2rem; font-weight: 600; margin-bottom: 24px; }
    .search-bar { max-width: 320px; }
    .filter-bar { max-width: 180px; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light" style="background:#4a90e2;">
    <div class="container-fluid">
      <a class="navbar-brand text-white" href="index.html">AcademyBlock</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link text-white" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link text-white active" href="tests.html">Tests</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="dashboard.html">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="#">Profile</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <div class="test-header">Tests</div>
    <div class="d-flex gap-3 mb-4">
      <input type="text" class="form-control search-bar" placeholder="Search tests...">
      <select class="form-select filter-bar">
        <option>Filter</option>
        <option>Beginner</option>
        <option>Intermediate</option>
        <option>Advanced</option>
      </select>
    </div>
    <div class="row g-4">
  <div id="examsList" class="row g-4"></div>
    </div>
  </div>
    <script type="module">
  import { HttpAgent, Actor } from "@dfinity/agent";
  import { idlFactory } from "../src/declarations/backend/backend.did.js";

  const canisterId = "uxrrr-q7777-77774-qaaaq-cai";
  const agent = new HttpAgent({ host: "http://127.0.0.1:4943" });
  const backend = Actor.createActor(idlFactory, { agent, canisterId });

  // List exams and render them
  async function loadExams() {
    try {
      const exams = await backend.list_exams();
      const examsList = document.getElementById("examsList");
      examsList.innerHTML = exams.map(exam => `
        <div class="col-md-4">
          <div class="card p-3">
            <div class="card-body">
              <h5 class="card-title">${exam.title}</h5>
              <p class="card-text">Exam ID: ${exam.id}</p>
              <button class="btn btn-primary" onclick="startTest(${exam.id})">Start Test</button>
            </div>
          </div>
        </div>
      `).join("");
    } catch (err) {
      alert("Error loading exams: " + err);
    }
  }

  window.startTest = function(examId) {
    localStorage.setItem("currentExamId", examId);
    window.location.href = "test.html";
  };

  loadExams();
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
